Return-Path: <dev-bounces@lists.openshift.redhat.com>
X-Original-To: rick@rudelinux.org
Delivered-To: x10112648@homiemail-mx17.g.dreamhost.com
Received: from mx3-phx2.redhat.com (mx3-phx2.redhat.com [209.132.183.24])
	by homiemail-mx17.g.dreamhost.com (Postfix) with ESMTP id AFFA8404306AD
	for <rick@rudelinux.org>; Wed, 22 Jan 2014 20:04:03 -0800 (PST)
Received: from lists03.pubmisc.prod.ext.phx2.redhat.com (lists03.pubmisc.prod.ext.phx2.redhat.com [10.5.19.48])
	by mx3-phx2.redhat.com (8.13.8/8.13.8) with ESMTP id s0N43OEZ015624;
	Wed, 22 Jan 2014 23:03:26 -0500
Received: from int-mx12.intmail.prod.int.phx2.redhat.com
	(int-mx12.intmail.prod.int.phx2.redhat.com [10.5.11.25])
	by lists03.pubmisc.prod.ext.phx2.redhat.com (8.13.8/8.13.8) with ESMTP
	id s0N43MkD020319
	for <dev-openshift@lists03.pubmisc.prod.ext.phx2.redhat.com>;
	Wed, 22 Jan 2014 23:03:22 -0500
Received: from mx1.redhat.com (ext-mx15.extmail.prod.ext.phx2.redhat.com
	[10.5.110.20])
	by int-mx12.intmail.prod.int.phx2.redhat.com (8.14.4/8.14.4) with ESMTP
	id s0N43Luj016074
	for <dev-openshift@redhat.com>; Wed, 22 Jan 2014 23:03:22 -0500
Received: from mail-ve0-f171.google.com (mail-ve0-f171.google.com
	[209.85.128.171])
	by mx1.redhat.com (8.14.4/8.14.4) with ESMTP id s0N43JNm018152
	for <dev@lists.openshift.redhat.com>; Wed, 22 Jan 2014 23:03:20 -0500
Received: by mail-ve0-f171.google.com with SMTP id pa12so792541veb.2
	for <dev@lists.openshift.redhat.com>;
	Wed, 22 Jan 2014 20:03:19 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
	d=1e100.net; s=20130820;
	h=x-gm-message-state:mime-version:from:date:message-id:subject:to:cc
	:content-type;
	bh=4r8y3LY+HAqU6KNmn8GcSYBMqCJZs2i6LAgCABdflPQ=;
	b=m8eM2T1NAzazy3Asels/Mj9jp9yiU87lr0cIYuTohwLlqFOY8xrX3Tx63Utdayo6uD
	im4sjAtfIQZ6sIE8iyCy6use1+Bw8IHxI/2dmm1ZoVZI11EFhP97Z+ooltKlNtNbOI6Q
	q9bIZXlXrUrLYUsDQrSzyxvkOqExCKthpoU0KFbAui+btYjRppuFefULSqPOT+pIaRG8
	KdzajwQDLbxy35xrNgQpRw/2waJ4qddLc0YlVDqA/YE3Cw7smtIvNk6av6PbCv44WqOb
	9ycl3MXAfGBhT62qnU3Fa4I5BVj3SxA/Owhsjjx2QQau9AkRMV4fzG4Oqqsi3Ia87KrG
	tK2w==
X-Gm-Message-State: ALoCoQkY7bcu3yjSrG7FHOfZeB5peMlTXEirQWNBPBwYhFZWSnlze1svDOBU6GT2GXNHdECufK0I
X-Received: by 10.221.7.132 with SMTP id oo4mr3262396vcb.31.1390449798985;
	Wed, 22 Jan 2014 20:03:18 -0800 (PST)
MIME-Version: 1.0
Received: by 10.58.112.234 with HTTP; Wed, 22 Jan 2014 20:02:58 -0800 (PST)
X-Originating-IP: [61.29.25.21]
From: Andrew Lau <andrew@andrewklau.com>
Date: Thu, 23 Jan 2014 15:02:58 +1100
Message-ID: <CAD7dF9cKEnhQXCzntcKEiwQkDTUJgs8BixZs_tAw+OspboUOHQ@mail.gmail.com>
Subject: Custom Cartridge Help (MariaDB Galera Cluster)
To: "dev@lists.openshift.redhat.com" <dev@lists.openshift.redhat.com>
X-RedHat-Spam-Score: -2.699  (BAYES_00, DCC_REPUT_13_19, HTML_MESSAGE,
	RCVD_IN_DNSWL_LOW)
X-Scanned-By: MIMEDefang 2.68 on 10.5.11.25
X-Scanned-By: MIMEDefang 2.68 on 10.5.110.20
X-loop: dev@redhat.com
Cc: Diane Mueller-Klingspor <dmueller@redhat.com>
X-BeenThere: dev@lists.openshift.redhat.com
X-Mailman-Version: 2.1.12
Precedence: junk
List-Id: Developer discussions around OpenShift and OpenShift Origin
	<dev.lists.openshift.redhat.com>
List-Unsubscribe: <http://lists.openshift.redhat.com/openshiftmm/options/dev>, 
	<mailto:dev-request@lists.openshift.redhat.com?subject=unsubscribe>
List-Archive: <http://lists.openshift.redhat.com/openshift-archives/dev>
List-Post: <mailto:dev@lists.openshift.redhat.com>
List-Help: <mailto:dev-request@lists.openshift.redhat.com?subject=help>
List-Subscribe: <http://lists.openshift.redhat.com/openshiftmm/listinfo/dev>, 
	<mailto:dev-request@lists.openshift.redhat.com?subject=subscribe>
Content-Type: multipart/mixed; boundary="===============8764543304694730816=="
Sender: dev-bounces@lists.openshift.redhat.com
Errors-To: dev-bounces@lists.openshift.redhat.com

--===============8764543304694730816==
Content-Type: multipart/alternative; boundary=089e0115f90258ce2d04f09b52a8

--089e0115f90258ce2d04f09b52a8
Content-Type: text/plain; charset=ISO-8859-1

Hi,

I was dissecting my possibility of running a MariaDB Galera cluster within
OpenShift a few days ago, but I got stuck on a few things I was hoping
someone could help me with:

I started here if anyone is interested in helping
https://github.com/andrewklau/openshift-galera-mariadb

- Is there a way to have an environment variable of some sort which could
list all the gears running? I would like to create the whole cartridge
similar to a web-app style so that it can scale infinitely. From what I
understand, environment variables set are global across all the gears upon
first run, but does that mean they can be dynamically updated? I need this
to write some logic to prevent a split brain. This is because the cluster
requires the first "gear" to be brought up with the slightly different
command.

- Can anyone explain a little further on how the inter-gear networking
works? Looking at this post on Master-Slave it appears there doesn't seem
to be anything special required which is really confusing me about the
whole multi-tenancy concept
https://www.openshift.com/blogs/cloudy-with-a-chance-of-data-master-slave-database-replication-on-openshift


- Is it possible to use the haproxy routing to loadbalance the requests to
the cluster? I'm not so familiar with haproxy, but I'm assuming as it can
run like a tcp loadbalancer similar to LVS (which I currently use for my
external cluster) I don't see why it couldn't work. It'd obviously need a
custom port?

- I think I read somewhere, that by default the gears will try to do
negative affinity by default when scaling out? eg. be hosted on a separate
node. Is that the default behavior, or am I thinking of something else?

- Am I wrong to assume this won't work with Online as it requires some
external dependencies from the MariaDB repo (not SCL)?

Any suggestions would be much appreciated.

Thanks,
Andrew.

--089e0115f90258ce2d04f09b52a8
Content-Type: text/html; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_default" style=3D"font-family:tahoma,s=
ans-serif"><div class=3D"gmail_default">Hi,</div><div class=3D"gmail_defaul=
t"><br></div><div class=3D"gmail_default">I was dissecting my possibility o=
f running a MariaDB Galera cluster within OpenShift a few days ago, but I g=
ot stuck on a few things I was hoping someone could help me with:</div>

<div class=3D"gmail_default"><br></div><div class=3D"gmail_default">I start=
ed here if anyone is interested in helping=A0<a href=3D"https://github.com/=
andrewklau/openshift-galera-mariadb">https://github.com/andrewklau/openshif=
t-galera-mariadb</a></div>

<div class=3D"gmail_default"><br></div><div class=3D"gmail_default">- Is th=
ere a way to have an environment variable of some sort which could list all=
 the gears running? I would like to create the whole cartridge similar to a=
 web-app style so that it can scale infinitely. From what I understand, env=
ironment variables set are global across all the gears upon first run, but =
does that mean they can be dynamically updated? I need this to write some l=
ogic to prevent a split brain. This is because the cluster requires the fir=
st &quot;gear&quot; to be brought up with the slightly different command.=
=A0</div>

<div class=3D"gmail_default"><br></div><div class=3D"gmail_default">- Can a=
nyone explain a little further on how the inter-gear networking works? Look=
ing at this post on Master-Slave it appears there doesn&#39;t seem to be an=
ything special required which is really confusing me about the whole multi-=
tenancy concept=A0<a href=3D"https://www.openshift.com/blogs/cloudy-with-a-=
chance-of-data-master-slave-database-replication-on-openshift">https://www.=
openshift.com/blogs/cloudy-with-a-chance-of-data-master-slave-database-repl=
ication-on-openshift</a>=A0</div>

<div class=3D"gmail_default"><br></div><div class=3D"gmail_default">- Is it=
 possible to use the haproxy routing to loadbalance the requests to the clu=
ster? I&#39;m not so familiar with haproxy, but I&#39;m assuming as it can =
run like a tcp loadbalancer similar to LVS (which I currently use for my ex=
ternal cluster) I don&#39;t see why it couldn&#39;t work. It&#39;d obviousl=
y need a custom port?</div>

<div class=3D"gmail_default"><br></div><div class=3D"gmail_default">- I thi=
nk I read somewhere, that by default the gears will try to do negative affi=
nity by default when scaling out? eg. be hosted on a separate node. Is that=
 the default behavior, or am I thinking of something else?</div>

<div class=3D"gmail_default"><br></div><div class=3D"gmail_default">- Am I =
wrong to assume this won&#39;t work with Online as it requires some externa=
l dependencies from the MariaDB repo (not SCL)?</div><div class=3D"gmail_de=
fault">

<br></div><div class=3D"gmail_default">Any suggestions would be much apprec=
iated.</div><div class=3D"gmail_default"><br></div><div class=3D"gmail_defa=
ult">Thanks,</div><div class=3D"gmail_default">Andrew.</div></div>
</div>

--089e0115f90258ce2d04f09b52a8--


--===============8764543304694730816==
Content-Type: text/plain; charset="us-ascii"
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

_______________________________________________
dev mailing list
dev@lists.openshift.redhat.com
http://lists.openshift.redhat.com/openshiftmm/listinfo/dev

--===============8764543304694730816==--

